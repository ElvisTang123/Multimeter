# Multimeter

# Abstract
* Created the multimeter’s AC/DC interface on Realterm through USART, USART’s interrupts.
* Calculated input signals’ Vpp and Vrms through sampling its voltages via ADC interrupt.
* Calculated the time interval between each ADC interrupt according to the frequency of the input signal to avoid over-sampling or under-sampling.
* Calculated the frequency of the input signal based on the interval between the two consecutive rising edges of the square wave that is generated by the comparator and the edges are captured by the timer’s interrupts.
* Generated the required square wave by configuring the DAC output value as the average voltage of the input signal and setting it as the reference voltage of the comparator.

# Project Introduction
This is a digital multimeter. It has a DC measure mode and an AC measure mode. It can handle inputs between 0 and 3 volts.  It is capable of reading waves with frequency from 1-1000 Hz. It can read sin, saw-tooth, square, and triangle waves. In DC mode, it reads the voltage level and outputs the corresponding voltage to the terminal. In AC mode it reads the frequency, peak to peak voltage, RMS voltage. When outputting to the terminal the device both displays the values numerically and it displays the values on a series of bar graphs.<br />

# System Specification
It can be seen from the below specifications of the LCD module that the size of the LCD monitor we used for the lockbox is sufficient, and the color contrast is very good. It can not only display the instructions clearly but also have enough space to key in the pins. The power requirement is 3.3V, which is basically very low, so we can use a very small power supply to drive the LCD. <br />

| Parameter | Value | Unit |
| :-----------:  | :-----------: |:-----------: |
| Voltage input| 0-3 | Volts |
| Input type |DC or most types of AC|---|
| Input frequency | 0 or 1-1000 |Hz|
| Freq_out error | +-max(5, 1% of freq) |Hz|
| Voltage our error| +- .25 |V|
| Data points used to read |1000|Points/period|
| Current input necessary | 300 |mA|
| Power source | USB |---|
| User interface | USART Terminal |---|
| Suggested scope probe setting | 1x |---|

# Schematic
<p align="center">
  <img src="Media/Schematic1.jpg" alt="" width="70%"/>
</p>

# Software Architecture
* Main Function:<br/>
Our main function has three cases, a default where the user picks between AC and DC voltage, then the AC measure and the DC measure. It chooses between them using a USART interrupt based on a key press from the user. In dc mode it measures and calculates the DC voltage (discussed later) then prints the result to the terminal. When printing to the terminal it prints DC then makes a bar graph by printing “0v” on colunm 0, “1v” on column 20, “2v” on column 40, and “3v” on column 60, on the next row it prints 60 columns of dashes. Finally, it converter the voltage to a corresponding number of columns out of 60 (3v =60 columns) and prints that many columns worth of “x” on the next row. The printing for all the bar graphs work in exactly this way. Once we print the values and everything we loop back to the beginning of the DC measurement procedure.<br/><br/>
In AC mode we first calculate the frequency. To do this we measure the wave form as many times as possible in .25 seconds (we want to measure at least a quarter of the wave when the wave is at its slowest). Using the max and min values (we find in real time) from that we calculate the middle value and write the DAC to output that value. The comparator then compares the wave and that DAC value to produce a square wave with frequency equal to the input wave form. Next, we initialize timer 2 to capture rising edges of that wave form and set up its interrupt to get two consecutive rising edges. From those edges we are able to calculate the frequency. We use USART to print the frequency to the terminal. Next, we use that frequency to calculate what frequency we want to use timer 5 to measure the wave. The idea is to get 1000 points on the wave regardless of the wave’s frequency. Then we use those 1000 points to calculate Vpp and Vrms. Finally, we print those values and their bar graphs to the terminal and loop back through.<br/>

<p align="center">
  <img src="Media/Main.jpg" alt="" width="50%"/>
</p>

* ADC_IRQ_Handler:<br/>


# Demonstration
